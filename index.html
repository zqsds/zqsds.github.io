<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta property="og:type" content="website">
<meta property="og:title" content="ZQ&#39;S blog">
<meta property="og:url" content="https://zqsds.github.io/index.html">
<meta property="og:site_name" content="ZQ&#39;S blog">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ZQ&#39;S blog">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://zqsds.github.io/"/>





  <title> ZQ'S blog </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">ZQ'S blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">我很懒~懒~懒。。。</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br />
            
            站点地图
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://zqsds.github.io/2017/06/14/PHP-类的接口-interface-与-implements-关键字/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhao Qiang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZQ'S blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/14/PHP-类的接口-interface-与-implements-关键字/" itemprop="url">
                  PHP 类的接口 interface 与 implements 关键字
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-14T10:26:37+08:00">
                2017-06-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="PHP-接口"><a href="#PHP-接口" class="headerlink" title="PHP 接口"></a>PHP 接口</h4><p>PHP 类是单继承，也就是不支持多继承，当一个类需要多个类的功能时，继承就无能为力了，为此 PHP 引入了类的接口技术。<br>如果一个抽象类里面的所有方法都是抽象方法，且没有声明变量，而且接口里面所有的成员都是 public 权限的，那么这种特殊的抽象类就叫 接口 。<br>接口使用关键字 interface 来定义，并使用关键字 implements 来实现接口中的方法，且必须完全实现。<br>.接口的介绍与创建</p>
<h4 id="接口的介绍与创建"><a href="#接口的介绍与创建" class="headerlink" title="接口的介绍与创建"></a>接口的介绍与创建</h4><p>接口：一种成员属性全部为抽象或常量的特殊抽象类。</p>
<h4 id="规则："><a href="#规则：" class="headerlink" title="规则："></a>规则：</h4><p>1.类中全部为抽象方法。<br>2.抽象方法钱不用加abstract。<br>3.接口抽象方法属性为public。<br>4.成员属性必须为常量。<br>格式代码如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">interface demo &#123; </div><div class="line">const NAME = &quot;常量对象属性&quot;; </div><div class="line">function fun1(); </div><div class="line">function fun2(); //抽象方法。 </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>例子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line">//定义接口</div><div class="line">interface User&#123;</div><div class="line">    function getDiscount();</div><div class="line">    function getUserType();</div><div class="line">&#125;</div><div class="line">//VIP用户 接口实现</div><div class="line">class VipUser implements User&#123;</div><div class="line">    // VIP 用户折扣系数</div><div class="line">    private $discount = 0.8;</div><div class="line">    function getDiscount() &#123;</div><div class="line">        return $this-&gt;discount;</div><div class="line">    &#125;</div><div class="line">    function getUserType() &#123;</div><div class="line">        return &quot;VIP用户&quot;;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">class Goods&#123;</div><div class="line">    var $price = 100;</div><div class="line">    var $vc;</div><div class="line">    //定义 User 接口类型参数，这时并不知道是什么用户</div><div class="line">    function run(User $vc)&#123;</div><div class="line">        $this-&gt;vc = $vc;</div><div class="line">        $discount = $this-&gt;vc-&gt;getDiscount();</div><div class="line">	$usertype = $this-&gt;vc-&gt;getUserType();</div><div class="line">        echo $usertype.&quot;商品价格：&quot;.$this-&gt;price*$discount;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">$display = new Goods();</div><div class="line">$display -&gt;run(new VipUser);	//可以是更多其他用户类型</div></pre></td></tr></table></figure>
<p>运行该例子，输出：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">VIP用户商品价格：80 元</div></pre></td></tr></table></figure>
<p>该例子演示了一个 PHP 接口的简单应用。该例子中，User 接口实现用户的折扣，而在 VipUser 类里面实现了具体的折扣系数。最后商品类 Goods 根据 User 接口来实现不同的用户报价。<br>该例子仅限于演示 PHP 接口的用法，不涉及其科学与否。</p>
<h4 id="接口的应用与规范"><a href="#接口的应用与规范" class="headerlink" title="接口的应用与规范"></a>接口的应用与规范</h4><p>接口引用区别于类继承关键字 extends ，继承只能只是单一性，而接口可以使用关键字 implements 多个引用并用逗号分开<br>1.格式：普通类引用接口</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">class MyPc implements demo , demo2 , demo3 &#123; </div><div class="line">... </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>2.格式：抽象类应用接口例子</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">abstract class MyPc implements demo , demo2 , demo3 &#123; </div><div class="line">... </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>3.格式：继承父类引用接口并存</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">class MyPc extends Root implements demo , demo2 , demo3 &#123; </div><div class="line">... </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>先继承后接口，单继承多接口。</p>
<p>4.格式：接口与接口的继承</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">interface demo3 extends demo &#123; </div><div class="line">... </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>实例代码如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line">&lt;?php </div><div class="line">interface demo &#123; </div><div class="line"> const NAME = &quot;名称&quot;; </div><div class="line"> function fun1(); </div><div class="line"> function fun2(); </div><div class="line">&#125; </div><div class="line">interface demo2 &#123; </div><div class="line"> function fun3(); </div><div class="line"> function fun4(); </div><div class="line">&#125; </div><div class="line">interface demo3 &#123; </div><div class="line"> const TEST = &quot;Test&quot;; </div><div class="line"> function fun5(); </div><div class="line">&#125; </div><div class="line">class MyPc implements demo, demo2 &#123; </div><div class="line"> function fun1() &#123; </div><div class="line">  echo &quot;++++++++++&lt;br /&gt;&quot;; </div><div class="line"> &#125; </div><div class="line"> function fun2() &#123; </div><div class="line">  echo &quot;----------&lt;br /&gt;&quot;; </div><div class="line"> &#125; </div><div class="line"> function fun3() &#123; </div><div class="line">  echo &quot;1111111111&lt;br /&gt;&quot;; </div><div class="line"> &#125; </div><div class="line"> function fun4() &#123; </div><div class="line">  echo &quot;2222222222&lt;br /&gt;&quot;; </div><div class="line"> &#125; </div><div class="line">&#125; </div><div class="line">class MyPs extends MyPc implements demo3 &#123; </div><div class="line"> function fun5() &#123; </div><div class="line">  echo &quot;继承类后引用接口&quot;; </div><div class="line"> &#125; </div><div class="line">&#125; </div><div class="line">$p = new MyPs; </div><div class="line">$p-&gt;fun1(); </div><div class="line">$p-&gt;fun2(); </div><div class="line">$p-&gt;fun3(); </div><div class="line">$p-&gt;fun4(); </div><div class="line">$p-&gt;fun5(); </div><div class="line">?&gt;</div></pre></td></tr></table></figure>
<p>抽象类和接口的区别</p>
<p>接口是特殊的抽象类，也可以看做是一个模型的规范。接口与抽象类大致区别如下：</p>
<p>1.一个子类如果 implements 一个接口，就必须实现接口中的所有方法（不管是否需要）；如果是继承一个抽象类，只需要实现需要的方法即可。</p>
<p>2.如果一个接口中定义的方法名改变了，那么所有实现此接口的子类需要同步更新方法名；而抽象类中如果方法名改变了，其子类对应的方法名将不受影响，只是变成了一个新的方法而已（相对老的方法实现）。</p>
<p>3.抽象类只能单继承，当一个子类需要实现的功能需要继承自多个父类时，就必须使用接口。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://zqsds.github.io/2017/06/14/PHP-单例模式和工厂模式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhao Qiang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZQ'S blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/14/PHP-单例模式和工厂模式/" itemprop="url">
                  PHP-单例模式和工厂模式
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-14T10:21:17+08:00">
                2017-06-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">设计模式是一套被反复使用、多数人知晓的、经过分类编目的、代码设计经验的总结。使用设计模式是为了可重用代码、让代码更容易被他人理解、保证代码可靠性。</div></pre></td></tr></table></figure>
<p>毫无疑问，设计模式于己于他人于系统都是多赢的；设计模式使代码编制真正工程化；设计模式是软件工程的基石脉络，如同大厦的结构一样。</p>
<h4 id="单例模式"><a href="#单例模式" class="headerlink" title="单例模式"></a>单例模式</h4><p>当需要保证某个对象只能有一个实例的时候，单例模式非常有用。它把创建对象的控制权委托到一个单一的点上，任何时候应用程序都只会仅有一个实例存在。单例类不应该可以在类的外部进行实例化一个单例类应该具备以下几个要素。<br>必须拥有一个访问级别为 private 的构造函数，有效防止类被随意实例化。<br>必须拥有一个保存类的实例的静态变量。<br>必须拥有一个访问这个实例的公共的静态方法，该方法通常被命名为 GetInstance()。<br>必须拥有一个私有的空的__clone方法，防止实例被克隆复制。<br>下面用一个简单的单例类的例子来说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">class ClassName</div><div class="line">&#123;</div><div class="line">    public static $_instance;</div><div class="line">    private function __construct()</div><div class="line">    &#123;</div><div class="line">        # code...</div><div class="line">    &#125;</div><div class="line">    private function __clone()</div><div class="line">    &#123;</div><div class="line">        # empty</div><div class="line">    &#125;</div><div class="line">    public static function GetInstance()</div><div class="line">    &#123;</div><div class="line">        if(!(self::$_instance instanceof self))</div><div class="line">        &#123;</div><div class="line">            self::$_instance = new self();</div><div class="line">        &#125;</div><div class="line">        return self::$_instance;</div><div class="line">    &#125;</div><div class="line">    public function SayHi()</div><div class="line">    &#123;</div><div class="line">        echo &quot;Hi boy!&quot;;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">$App= ClassName::GetInstance();</div><div class="line">$App-&gt;SayHi();</div><div class="line">/**</div><div class="line"> *</div><div class="line"> * Output</div><div class="line"> *</div><div class="line"> * Hi boy! </div><div class="line"> *</div><div class="line"> */</div></pre></td></tr></table></figure>
<h4 id="简单工厂模式"><a href="#简单工厂模式" class="headerlink" title="简单工厂模式"></a>简单工厂模式</h4><p>当你有大量的实现同一接口的类的时候，在合适的时候实例化合适的类，如果把这些 new 分散到项目的各个角落，不仅会使业务逻辑变的混乱并且使得项目难以维护。这时候如果引进工厂模式的概念，就能很好的处理这个问题。我们还可以通过应用程序配置或者提供参数的形式让工厂类为我们返回合适的的实例。<br>工厂类，它把实例化类的过程放到各工厂类里头，专门用来创建其他类的对象。工厂模式往往配合接口一起使用，这样应用程序就不必要知道这些被实例化的类的具体细节，只要知道工厂返回的是支持某个接口的类可以很方便的使用了。下面简单举例说明下工厂类的使用。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line">interface ProductInterface</div><div class="line">&#123;</div><div class="line">    public function showProductInfo();</div><div class="line">&#125;</div><div class="line">class ProductA implements ProductInterface</div><div class="line">&#123;</div><div class="line">    function showProductInfo()</div><div class="line">    &#123;</div><div class="line">        echo &apos;This is product A.&apos;;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">class ProductB implements ProductInterface</div><div class="line">&#123;</div><div class="line">    function showProductInfo()</div><div class="line">    &#123;</div><div class="line">        echo &apos;This is product B.&apos;;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">class ProductFactory</div><div class="line">&#123;</div><div class="line">    public static function factory($ProductType)</div><div class="line">    &#123;        </div><div class="line">        $ProductType = &apos;Product&apos; . strtoupper($ProductType);</div><div class="line">        if(class_exists($ProductType))</div><div class="line">        &#123;</div><div class="line">            return new $ProductType();</div><div class="line">        &#125;</div><div class="line">        else</div><div class="line">        &#123;</div><div class="line">            throw new Exception(&quot;Error Processing Request&quot;, 1);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">//这里需要一个产品型号为 A 的对象</div><div class="line">$x = ProductFactory::factory(&apos;A&apos;);</div><div class="line">$x -&gt; showProductInfo();</div><div class="line">//这里需要一个产品型号为 B 的对象</div><div class="line">$o = ProductFactory::factory(&apos;B&apos;);</div><div class="line">$o -&gt; showProductInfo();</div><div class="line">//都可以调用showProductInfo方法，因为都实现了接口 ProductInterface.</div></pre></td></tr></table></figure>
<h4 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h4><p>模式就像是软件工程的基石脉络像大厦的设计图纸一样，这里接触了两种模式：单例模式和工程模式。单例类中存在一个静态变量保存着自身的一个实例，并且提供了获取这个静态变量的静态方法。单例类还应该把构造函数和clone函数标记为私有的，防止破换实例的唯一性。工厂模式根据传入的参数或程序的配置来创建不同的类型实例，工厂类返回的是对象，工厂类在多态性编程实践中是至关重要的。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://zqsds.github.io/2017/06/06/php闭包/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhao Qiang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZQ'S blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/06/php闭包/" itemprop="url">
                  php闭包
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-06T14:50:30+08:00">
                2017-06-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>之前就觉得php闭包很好用，但是平时很少用也就忘了，闲的无聊的时候突然想起来了，今天来复习一下；</p>
<h6 id="匿名函数"><a href="#匿名函数" class="headerlink" title="匿名函数"></a>匿名函数</h6><p>提到闭包就不得不想起匿名函数，也叫闭包函数（closures）,貌似PHP闭包实现主要就是靠它。声明一个匿名函数是这样：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$func = function()&#123;</div><div class="line">    </div><div class="line">&#125;;//带结束符</div></pre></td></tr></table></figure>
<p>可以看到，匿名函数因为没有名字，如果要使用它，需要将其返回给一个变量。匿名函数也像普通函数一样可以声明参数，调用方法也相同：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">代码如下：</div><div class="line">$func = function($param)&#123;</div><div class="line">    echo $param;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">$func(&apos;somne string&apos;);</div><div class="line">//输出:</div><div class="line">//some string</div></pre></td></tr></table></figure>
<p>顺便提一下，PHP在引入闭包之前，也有一个可以创建匿名函数的函数：create function，但是代码逻辑只能写成字符串，这样看起来很晦涩并且不好维护，所以很少有人用。</p>
<h6 id="实现闭包"><a href="#实现闭包" class="headerlink" title="实现闭包"></a>实现闭包</h6><p>将匿名函数在普通函数中当参数传入，也可以被返回。这就实现了一个简单的闭包。</p>
<p>######下面有三个例子</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line">//例子一</div><div class="line">//在函数里定义一个匿名函数，并且调用它</div><div class="line">function printStr()&#123;</div><div class="line">    $func = function($str)&#123;</div><div class="line">        echo $str;</div><div class="line">    &#125;;</div><div class="line">    </div><div class="line">    $func(&apos;some string&apos;);</div><div class="line">    </div><div class="line">&#125;</div><div class="line"></div><div class="line">printStr();</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">//例二</div><div class="line">//在函数中把匿名函数返回，并且调用它</div><div class="line">function getPrintStrFunc()&#123;</div><div class="line">    $func = function($str)&#123;</div><div class="line">        echo $str;</div><div class="line">    &#125;;</div><div class="line">    return $func;</div><div class="line">&#125;</div><div class="line"></div><div class="line">$printStrFunc = getPrintStrFunc();</div><div class="line">$printStrFunc(&apos;some string&apos;);</div><div class="line"></div><div class="line">//例三</div><div class="line">//把匿名函数当做参数传递，并且调用它</div><div class="line">function callFunc($func)&#123;</div><div class="line">    $func(&apos;some string&apos;);</div><div class="line">&#125;</div><div class="line">$print = function($str)&#123;</div><div class="line">    echo $str;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">callFunc($print);</div></pre></td></tr></table></figure>
<p>连接闭包和外界变量的关键字：USE</p>
<p>闭包可以保存所在代码块上下文的一些变量和值。PHP在默认情况下，匿名函数不能调用所在代码块的上下文变量，而需要通过使用use关键字。</p>
<p>换一个例子看看：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">function getMoney()&#123;</div><div class="line">    $rmb = 1;</div><div class="line">    $dollar = 6;</div><div class="line">    $func = function() use ($rmb)&#123;</div><div class="line">        echo $rmb;</div><div class="line">        echo $dollar;</div><div class="line">    &#125;;</div><div class="line">    </div><div class="line">    $func();</div><div class="line">&#125;</div><div class="line"></div><div class="line">getMoney();</div><div class="line">//输出：</div><div class="line">//1</div><div class="line">//报错，找不到dorllar变量</div></pre></td></tr></table></figure>
<p>可以看到，dollar没有在use关键字中声明，在这个匿名函数里也就不能获取到它，所以开发中要注意这个问题。</p>
<p>有人可能会想到，是否可以在匿名函数中改变上下文的变量，但我发现是不可以的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">function getMoney() &#123;</div><div class="line">    $rmb = 1;</div><div class="line">    $func = function() use ( $rmb ) &#123;</div><div class="line">        //把$rmb的值加1</div><div class="line">        $rmb++;</div><div class="line">        echo $rmb.&quot;&lt;br&gt;&quot;;</div><div class="line">    &#125;;</div><div class="line">    $func();</div><div class="line">    echo $rmb;</div><div class="line">&#125;</div><div class="line">getMoney();</div><div class="line">//输出：</div><div class="line">//2</div><div class="line">//1</div></pre></td></tr></table></figure>
<p>啊，原来use所引用的也只不过是变量的一个副本而已。但是我想要完全引用变量，而不是复制。<br>要达到这种效果，其实在变量前加一个 &amp; 符号就可以了：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">function getMoney() &#123;</div><div class="line">    $rmb = 1;</div><div class="line">    $func = function() use ( &amp;$rmb ) &#123;</div><div class="line">        //把$rmb的值加1</div><div class="line">        $rmb++;</div><div class="line">        echo $rmb.&quot;&lt;br&gt;&quot;;</div><div class="line">    &#125;;</div><div class="line">    $func();</div><div class="line">    echo $rmb;</div><div class="line">&#125;</div><div class="line">getMoney();</div><div class="line">//输出：</div><div class="line">//2</div><div class="line">//2</div></pre></td></tr></table></figure></p>
<p>好，这样匿名函数就可以引用上下文的变量了。如果将匿名函数返回给外界，匿名函数会保存use所引用的变量，而外界则不能得到这些变量，这样形成‘闭包’这个概念可能会更清晰一些。</p>
<h6 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h6><p>PHP闭包的特性并没有太大惊喜，其实用CLASS就可以实现类似甚至强大得多的功能，更不能和js的闭包相提并论，只能期待PHP以后对闭包支持的改进。不过匿名函数还是挺有用的，比如在使用preg_replace_callback等之类的函数可以不用在外部声明回调函数了。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://zqsds.github.io/2017/05/08/php的event扩展安装/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhao Qiang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZQ'S blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/05/08/php的event扩展安装/" itemprop="url">
                  php的event扩展安装
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-08T17:23:29+08:00">
                2017-05-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>php7下安装event扩展</p>
<p>有效安排I/O，时间和信号的扩展 使用可用于特定平台的最佳I/O通知机制的事件,是PHP基础设施的libevent端口。</p>
<ul>
<li>安装支持库libevent，需要编译高版本（这里以最新版本release-2.1.8-stable为例）</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">1.wget -c https://github.com/libevent/libevent/releases/download/release-2.1.8-stable/libevent-2.1.8-stable.tar.gz -P /usr/local/src</div><div class="line">2.cd /usr/local/src</div><div class="line">3.tar -zxvf libevent-2.1.8-stable.tar.gz &amp;&amp; cd libevent-2.1.8-stable</div><div class="line">4. ./configure --prefix=/usr/local/libevent-2.1.8</div><div class="line">make &amp;&amp; make install</div></pre></td></tr></table></figure>
<ul>
<li>安装event库（以event-2.3.0.tgz为例）</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">1.wget -c http://pecl.php.net/get/event-2.3.0.tgz -P /usr/local/src</div><div class="line">2.cd /usr/local/src</div><div class="line">3.tar -zxvf event-2.3.0.tgz &amp;&amp; cd event-2.3.0</div><div class="line">4./usr/local/php/bin/phpize</div><div class="line">5. ./configure --with-php-config=/usr/local/php/bin/php-config --with-event-libevent-dir=/usr/local/libevent-2.1.8/</div><div class="line">make &amp;&amp; make install</div></pre></td></tr></table></figure>
<ul>
<li>在php.ini添加下面配置</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">extension=event.so</div></pre></td></tr></table></figure>
<ul>
<li>重启php-fpm</li>
</ul>
<p>PHP-FPM是一个PHP FastCGI管理器，是只用于PHP的。 　　<br>PHP-FPM其实是PHP源代码的一个补丁，旨在将FastCGI进程管理整合进PHP包中。必须将它patch到你的PHP源代码中，在编译安装PHP后才可以使用。 　　现在我们可以在最新的PHP 5.3.2的源码树里下载得到直接整合了PHP-FPM的分支，据说下个版本会融合进PHP的主分支去。相对Spawn-FCGI，PHP-FPM在CPU和内存方面的控制都更胜一筹，而且前者很容易崩溃，必须用crontab进行监控，而PHP-FPM则没有这种烦恼。 　　<br>PHP5.3.3已经集成php-fpm了，不再是第三方的包了。PHP-FPM提供了更好的PHP进程管理方式，可以有效控制内存和进程、可以平滑重载PHP配置，比spawn-fcgi具有更多优点，所以被PHP官方收录了。在./configure的时候带 –enable-fpm参数即可开启PHP-FPM。 　　使用PHP-FPM来控制PHP-CGI的FastCGI进程<br>master进程可以理解以下信号<br>INT, TERM 立刻终止<br>QUIT 平滑终止<br>USR1 重新打开日志文件<br>USR2 平滑重载所有worker进程并重新载入配置和二进制模块<br>示例：<br>php-fpm 关闭(方法一)：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">kill -INT `cat /usr/local/php/var/run/php-fpm.pid`</div></pre></td></tr></table></figure></p>
<p>php-fpm 重启：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">kill -USR2 `cat /usr/local/php/var/run/php-fpm.pid`</div></pre></td></tr></table></figure></p>
<p>查看php-fpm进程数：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ps aux | grep -c php-fpm</div></pre></td></tr></table></figure></p>
<p>php-fmp的重启 (方法二）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">先执行</div><div class="line">killall php-fpm</div><div class="line">再执行(usr/local/php是php的安装目录)</div><div class="line"> 代码如下</div><div class="line">/usr/local/php/sbin/php-fpm &amp;</div></pre></td></tr></table></figure></p>
<ul>
<li>使用php -m | grep event 查看event库插件是否安装成功</li>
<li>php –ini 查看php.ini位置</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://zqsds.github.io/2017/05/04/git撤销修改和撤销删除操作/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhao Qiang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZQ'S blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/05/04/git撤销修改和撤销删除操作/" itemprop="url">
                  git撤销修改和撤销删除操作
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-04T14:48:50+08:00">
                2017-05-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>PS：最近不太忙加上用git现在很少犯错，只会机械的操作pull、commit、push操作，导致今天在本地删错了文件却忘了怎么操作，只能百度，记性不好啦，老咯~~，下面把这写入自己的博客方便以后查找。</p>
<h3 id="1-修改最后一次提交-git-commit-–amend"><a href="#1-修改最后一次提交-git-commit-–amend" class="headerlink" title="1 修改最后一次提交 git commit –amend"></a>1 修改最后一次提交 git commit –amend</h3><p>1.新建一个文件 2.提交一个之前的更改</p>
<p><img src="http://omdrnmjns.bkt.clouddn.com/17-5-4/74495215-file_1493881248148_1dc4.png" alt="image"></p>
<p>3.跟踪这个文件 4.跟前一次一起提交</p>
<p><img src="http://omdrnmjns.bkt.clouddn.com/17-5-4/97358370-file_1493881288882_11d4e.png" alt="image"></p>
<p> 提示你是否重新编辑提交说明，如果不编辑退出后还是跟之前一样提交</p>
<p> <img src="http://omdrnmjns.bkt.clouddn.com/17-5-4/97693445-file_1493881335688_174a4.png" alt="image"></p>
<p> <img src="http://omdrnmjns.bkt.clouddn.com/17-5-4/97693445-file_1493881335688_174a4.png" alt="image"></p>
<p> commit 成功</p>
<p>或 Git commit -m “” 可以直接提交</p>
<h3 id="2-撤消已暂存的文件-git-reset-HEAD"><a href="#2-撤消已暂存的文件-git-reset-HEAD" class="headerlink" title="2 撤消已暂存的文件 git reset HEAD"></a>2 撤消已暂存的文件 git reset HEAD</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line">#新建两个文件</div><div class="line">bixiaopeng@bixiaopengtekiMacBook-Pro wirelessqa$ touch 1txt</div><div class="line">bixiaopeng@bixiaopengtekiMacBook-Pro wirelessqa$ touch 2txt</div><div class="line">#全部暂存</div><div class="line">bixiaopeng@bixiaopengtekiMacBook-Pro wirelessqa$ git add -A</div><div class="line">#查看文件状态</div><div class="line">bixiaopeng@bixiaopengtekiMacBook-Pro wirelessqa$ git status</div><div class="line"># On branch master</div><div class="line"># Your branch is ahead of &apos;origin/master&apos; by 1 commit.</div><div class="line">#   (use &quot;git push&quot; to publish your local commits)</div><div class="line">#</div><div class="line"># Changes to be committed:</div><div class="line">#   (use &quot;git reset HEAD &lt;file&gt;...&quot; to unstage)</div><div class="line">#</div><div class="line">#     new file:   1txt</div><div class="line">#     new file:   2txt</div><div class="line"># </div><div class="line"></div><div class="line"></div><div class="line">#取消暂存 1txt</div><div class="line">bixiaopeng@bixiaopengtekiMacBook-Pro wirelessqa$ git reset HEAD 1txt</div><div class="line">#再次查看文件状态，1txt 已经被取消啦</div><div class="line"></div><div class="line">bixiaopeng@bixiaopengtekiMacBook-Pro wirelessqa$ git status</div><div class="line"># On branch master</div><div class="line"># Your branch is ahead of &apos;origin/master&apos; by 1 commit.</div><div class="line">#   (use &quot;git push&quot; to publish your local commits)</div><div class="line">#</div><div class="line"># Changes to be committed:</div><div class="line">#   (use &quot;git reset HEAD &lt;file&gt;...&quot; to unstage)</div><div class="line">#</div><div class="line">#     new file:   2txt</div><div class="line">#</div><div class="line"># Untracked files:</div><div class="line">#   (use &quot;git add &lt;file&gt;...&quot; to include in what will be committed)</div><div class="line">#</div><div class="line">#     1txt</div></pre></td></tr></table></figure>
<h3 id="3-撤消对文件的修改-git-checkout-–"><a href="#3-撤消对文件的修改-git-checkout-–" class="headerlink" title="3 撤消对文件的修改 git checkout – "></a>3 撤消对文件的修改 git checkout – <file></file></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">bixiaopeng@bixiaopengtekiMacBook-Pro wirelessqa$ ls</div><div class="line">README          TEST            android-package ios-package     testamend</div><div class="line">#修改文件testmend</div><div class="line">bixiaopeng@bixiaopengtekiMacBook-Pro wirelessqa$ vim testamend</div><div class="line">bixiaopeng@bixiaopengtekiMacBook-Pro wirelessqa$ git status</div><div class="line"># On branch master</div><div class="line"># Your branch is ahead of &apos;origin/master&apos; by 1 commit.</div><div class="line">#   (use &quot;git push&quot; to publish your local commits)</div><div class="line">#</div><div class="line"># Changes not staged for commit:</div><div class="line">#   (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)</div><div class="line">#   (use &quot;git checkout -- &lt;file&gt;...&quot; to discard changes in working directory)</div><div class="line">#</div><div class="line">#     modified:   testamend</div><div class="line">#</div><div class="line">no changes added to commit (use &quot;git add&quot; and/or &quot;git commit -a”)</div><div class="line">#撤消文件的修改</div><div class="line">bixiaopeng@bixiaopengtekiMacBook-Pro wirelessqa$ git checkout -- testamend</div><div class="line">bixiaopeng@bixiaopengtekiMacBook-Pro wirelessqa$ git status</div><div class="line"># On branch master</div><div class="line"># Your branch is ahead of &apos;origin/master&apos; by 1 commit.</div><div class="line">#   (use &quot;git push&quot; to publish your local commits)</div><div class="line">#</div><div class="line">nothing to commit, working directory clean</div></pre></td></tr></table></figure>
<h3 id="4-Git撤消commit"><a href="#4-Git撤消commit" class="headerlink" title="4 Git撤消commit"></a>4 Git撤消commit</h3><p>git log查看日志，找到需要回退的那次commit的 哈希值</p>
<p><img src="http://omdrnmjns.bkt.clouddn.com/17-5-4/80033682-file_1493881484503_e5c5.png" alt="image"></p>
<ol>
<li>git reset –hard commit_id</li>
</ol>
<p><img src="http://omdrnmjns.bkt.clouddn.com/17-5-4/32159086-file_1493881506810_117e7.png" alt="image"></p>
<h3 id="5-Git版本回退"><a href="#5-Git版本回退" class="headerlink" title="5 Git版本回退"></a>5 Git版本回退</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">#查看log</div><div class="line">bixiaopeng@bixiaopengtekiMacBook-Pro wirelessqa$ git log</div><div class="line">commit 047cd2d2f6bd1ecdcdb4854b728300aeaa314b80</div><div class="line">Author: 小朋 &lt;xiaopeng.bxp@****.com&gt;</div><div class="line">Date:   Thu Jan 2 22:26:50 2014 +0800</div><div class="line"></div><div class="line"></div><div class="line">    1test</div><div class="line"></div><div class="line"></div><div class="line">commit fa7fd8d49f3789d39aa3cc52cd81e09e6d061719</div><div class="line">Author: 小朋 &lt;xiaopeng.bxp@****.com&gt;</div><div class="line">Date:   Tue Dec 31 13:29:45 2013 +0800</div><div class="line"></div><div class="line"></div><div class="line">    delete test2</div><div class="line"></div><div class="line"></div><div class="line">commit 746f92258e2bc65c46f77f37315f577091192885</div><div class="line">Author: 小朋 &lt;xiaopeng.bxp@****.com&gt;</div><div class="line">Date:   Tue Dec 31 13:22:07 2013 +0800</div><div class="line"></div><div class="line"></div><div class="line">    test git commit -a </div><div class="line"></div><div class="line">…..</div></pre></td></tr></table></figure>
<p> HEAD是指向最新的提交，上一次提交是HEAD^,上上次是HEAD^^,也可以写成HEAD～2 ,依次类推</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">#放弃本地所有修改，回退到上一个版本</div><div class="line">bixiaopeng@bixiaopengtekiMacBook-Pro wirelessqa$ git reset --hard HEAD^</div><div class="line">HEAD is now at fa7fd8d delete test2</div></pre></td></tr></table></figure>
<p> 注： –hard 表示放弃所有本地改动</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">#再次查看log</div><div class="line">bixiaopeng@bixiaopengtekiMacBook-Pro wirelessqa$ git log</div><div class="line">commit fa7fd8d49f3789d39aa3cc52cd81e09e6d061719</div><div class="line">Author: 小朋 &lt;xiaopeng.bxp@****.com&gt;</div><div class="line">Date:   Tue Dec 31 13:29:45 2013 +0800</div><div class="line"></div><div class="line"></div><div class="line">    delete test2</div><div class="line"></div><div class="line"></div><div class="line">commit 746f92258e2bc65c46f77f37315f577091192885</div><div class="line">Author: 小朋 &lt;xiaopeng.bxp@****.com&gt;</div><div class="line">Date:   Tue Dec 31 13:22:07 2013 +0800</div><div class="line"></div><div class="line"></div><div class="line">    test git commit -a</div><div class="line"></div><div class="line"></div><div class="line">commit e301c4e185b0937d1ce9484ea86ab401e95c976c</div><div class="line">Author: 小朋 &lt;xiaopeng.bxp@****.com&gt;</div><div class="line">Date:   Tue Dec 31 13:14:42 2013 +0800</div><div class="line"></div><div class="line"></div><div class="line">    just test</div></pre></td></tr></table></figure>
<p> 回退到指定的版本 git reset –hard &lt;哈希值&gt;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">bixiaopeng@bixiaopengtekiMacBook-Pro wirelessqa$ git reset --hard 746f92258e2bc65c46f77f37315f577091192885</div><div class="line">HEAD is now at 746f922 test git commit -a</div></pre></td></tr></table></figure>
<h3 id="6-撤消未跟踪文件-git-clean-dxf"><a href="#6-撤消未跟踪文件-git-clean-dxf" class="headerlink" title="6 撤消未跟踪文件 git clean -dxf"></a>6 撤消未跟踪文件 git clean -dxf</h3><p>举个例子」</p>
<p>清除所有未跟踪文件，包括纳入ignored的文件。如果要保留ignored的文件修改，使用参数-df</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">＃清除所有未跟踪文件，包括纳入ignored的文件</div><div class="line">bixiaopeng@bixiaopeng-To-be-filled-by-O-E-M:~/workspace2/spark$ git clean -dxf</div><div class="line">正删除 .idea/</div><div class="line">正删除 .package.sh.swp</div><div class="line">正删除 assets/sparklog/</div><div class="line">正删除 backup-config/AndroidManifest.xml</div><div class="line">正删除 backup-config/channel_config.xml</div><div class="line">正删除 backup-res/assets/</div><div class="line">正删除 backup-res/res/</div><div class="line">正删除 debug</div><div class="line">正删除 package/spark_2.4_L95_91zhuomian.apk</div><div class="line">正删除 res/values/channel_config.xmlg</div><div class="line">正删除 target/</div><div class="line">正删除 xiamimusic.iml</div><div class="line">＃再查看一下未跟踪的文件已经被撤消了</div><div class="line">bixiaopeng@bixiaopeng-To-be-filled-by-O-E-M:~/workspace2/spark$ git status</div><div class="line"># 位于分支 test</div><div class="line"># 尚未暂存以备提交的变更：</div><div class="line"># （使用 &quot;git add &lt;file&gt;...&quot; 更新要提交的内容）</div><div class="line"># （使用 &quot;git checkout -- &lt;file&gt;...&quot; 丢弃工作区的改动）</div><div class="line">#</div><div class="line"># 修改： pom.xml</div><div class="line">#</div><div class="line">修改尚未加入提交（使用 &quot;git add&quot; 和/或 &quot;git commit -a&quot;）｀</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://zqsds.github.io/2017/05/04/浅谈宏定义使用技巧/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhao Qiang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZQ'S blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/05/04/浅谈宏定义使用技巧/" itemprop="url">
                  浅谈宏定义使用技巧
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-04T13:38:34+08:00">
                2017-05-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p> 1、宏定义介绍<br>      宏定义又称为宏替换，简称宏。它是在预处理阶段用预先定义的字符串替代标识符的过程。其定义的一般形式为：</p>
<p> #define    标识符    字符串<br> 宏定义中的标识符都采用大写，这是编程中一种约定俗成的习惯。在了解如何使用宏定义之前，我们先来了解使用宏的过程中需要注意的几个要点。</p>
<p> 1）宏替换不做语法检查，所以在使用的时候要格外小心。   </p>
<p> 2）宏替换通常在文件开头部分，写在函数的花括号外边，作用域为其后的程序，直到用   ?</p>
<p>3）# u n d e f 命令终止宏定义的作用域。</p>
<p>4）不要在字符串中使用宏，如果宏名出现在字符串中，那么将按字符串进行处理</p>
<p>2、宏定义会用的意义<br>    1 ）减少不必要的修改，提升程序的可预读性<br>    2 ）提升代码的可移植性 </p>
<p>3、 如何使用宏定义实现变参     </p>
<p>#define    print(…)   printf(<strong>VA_ARGS</strong>)<br>    在这个宏中，“. . . ”指可变参数。可变参数的实现方式就是使用“. . . ”所代表的内容替代<br><em> </em> VA <em> A R G S </em> _ ，看看下面的代码。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">#include &lt;stdio.h&gt;</div><div class="line"></div><div class="line">#ifdef TEMP</div><div class="line">#define print(...) printf(__VA_ARGS__)</div><div class="line">#else</div><div class="line">#define print(temp, ...) fprintf(stdout, temp, ##__VA_ARGS__)</div><div class="line">#endif</div><div class="line">int main()</div><div class="line">&#123;</div><div class="line">    </div><div class="line">    print(&quot;hello world-------%dn&quot;,1111);</div><div class="line">    return 0;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>编译时带 -DTEMP或不带的情况都能正确打印出要打印的内容。但是在第二个宏定义时加##是什么意思？</p>
<p> “#” 的作用就是对其后面的宏参数进行字符串化操作；##作用是粘合，将前后两个部分粘合成一个整体。</p>
<hr>
<p>下面在其他博客中中找到的相关说明，来看下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">#define A          (2) </div><div class="line">#define STR(s)     #s </div><div class="line">#define CONS(a,b)  int(a##e##b) </div><div class="line"></div><div class="line">printf(&quot;int max: %sn&quot;,  STR(INT_MAX));    // INT_MAX #i nclude </div><div class="line">这行会被展开为: </div><div class="line">printf(&quot;int max: %sn&quot;, &quot;INT_MAX&quot;); </div><div class="line"></div><div class="line">printf(&quot;%sn&quot;, CONS(A, A));               // compile error   </div><div class="line">这一行则是: </div><div class="line">printf(&quot;%sn&quot;, int(AeA));</div></pre></td></tr></table></figure>
<p>INT_MAX和A都不会再被展开, 然而解决这个问题的方法很简单. 加多一层中间转换宏.<br>加这层宏的用意是把所有宏的参数在这层里全部展开, 那么在转换宏里的那一个宏(_STR)就能得到正确的宏参数. </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">#define A           (2) </div><div class="line">#define _STR(s)     #s </div><div class="line">#define STR(s)      _STR(s)          // 转换宏 </div><div class="line">#define _CONS(a,b)  int(a##e##b) </div><div class="line">#define CONS(a,b)   _CONS(a,b)       // 转换宏 </div><div class="line"></div><div class="line">printf(&quot;int max: %sn&quot;, STR(INT_MAX));          // INT_MAX,int型的最大值,为一个变量 #i nclude </div><div class="line">输出为: int max: 0x7fffffff </div><div class="line">STR(INT_MAX) --&gt;  _STR(0x7fffffff) 然后再转换成字符串; </div><div class="line"></div><div class="line">printf(&quot;%dn&quot;, CONS(A, A)); </div><div class="line">输出为:200 </div><div class="line">CONS(A, A)  --&gt;  _CONS((2), (2))  --&gt; int((2)e(2))</div></pre></td></tr></table></figure>
<p>三、’#’和’##’的一些应用特例<br>1、合并匿名变量名 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">#define  ___ANONYMOUS1(type, var, line)  type  var##line </div><div class="line">#define  __ANONYMOUS0(type, line)  ___ANONYMOUS1(type, _anonymous, line) </div><div class="line">#define  ANONYMOUS(type)  __ANONYMOUS0(type, __LINE__) </div><div class="line">例:ANONYMOUS(static int);  即: static int _anonymous70;  70表示该行行号; </div><div class="line">第一层:ANONYMOUS(static int);  --&gt;  __ANONYMOUS0(static int, __LINE__); </div><div class="line">第二层:                        --&gt;  ___ANONYMOUS1(static int, _anonymous, 70); </div><div class="line">第三层:                        --&gt;  static int  _anonymous70;</div></pre></td></tr></table></figure>
<p>即每次只能解开当前层的宏,所以<strong>LINE</strong>在第二层才能被解开;</p>
<p>2、填充结构 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">#define  FILL(a)   &#123;a, #a&#125; </div><div class="line"></div><div class="line">enum IDD&#123;OPEN, CLOSE&#125;; </div><div class="line">typedef struct MSG&#123; </div><div class="line">  IDD id; </div><div class="line">  const char * msg; </div><div class="line">&#125;MSG; </div><div class="line"></div><div class="line">MSG _msg[] = &#123;FILL(OPEN), FILL(CLOSE)&#125;; </div><div class="line">相当于: </div><div class="line">MSG _msg[] = &#123;&#123;OPEN, &quot;OPEN&quot;&#125;, </div><div class="line">              &#123;CLOSE, &quot;CLOSE&quot;&#125;&#125;;</div></pre></td></tr></table></figure>
<p>3、记录文件名 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">#define  _GET_FILE_NAME(f)   #f </div><div class="line">#define  GET_FILE_NAME(f)    _GET_FILE_NAME(f) </div><div class="line">static char  FILE_NAME[] = GET_FILE_NAME(__FILE__);</div></pre></td></tr></table></figure>
<p>4、得到一个数值类型所对应的字符串缓冲大小 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">#define  _TYPE_BUF_SIZE(type)  sizeof #type </div><div class="line">#define  TYPE_BUF_SIZE(type)   _TYPE_BUF_SIZE(type)</div><div class="line">char  buf[TYPE_BUF_SIZE(INT_MAX)]; </div><div class="line">     --&gt;  char  buf[_TYPE_BUF_SIZE(0x7fffffff)]; </div><div class="line">     --&gt;  char  buf[sizeof &quot;0x7fffffff&quot;];</div></pre></td></tr></table></figure>
<p>这里相当于:<br>char  buf[11];<br>使用一些宏跟踪调试 </p>
<p>A N S I标准说明了五个预定义的宏名。它们是： </p>
<p><em> L I N E </em> (两个下划线)，对应%d</p>
<p><em> F I L E </em>    对应%s</p>
<p><em> D A T E </em>   对应%s</p>
<p><em> T I M E </em>   对应%s</p>
<p><em> S T D C </em> </p>
<p>如果编译不是标准的,则可能仅支持以上宏名中的几个,或根本不支持。记住编译程序 </p>
<p>也许还提供其它预定义的宏名。 </p>
<p><em> L I N E </em>及<em> F I L E </em>宏指令在有关# l i n e的部分中已讨论,这里讨论其余的宏名。 </p>
<p><em> D AT E </em>宏指令含有形式为月/日/年的串,表示源文件被翻译到代码时的日期。 </p>
<p>源代码翻译到目标代码的时间作为串包含在<em> T I M E </em>中。串形式为时：分：秒。 </p>
<p>如果实现是标准的,则宏<em> S T D C </em>含有十进制常量1。如果它含有任何其它数,则实现是 </p>
<p>非标准的。 </p>
<hr>
<p>下面是个例子，介绍上述宏定义在代码调试中的例子</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">#define return_exam(p) if(!(p))  </div><div class="line">&#123;printf(&quot;error: &quot;#p&quot; file_name:%stfunction_name:%stline:%d .n&quot;,  </div><div class="line">            __FILE__, __func__, __LINE__); return 0;&#125;</div><div class="line"></div><div class="line">int print()</div><div class="line">&#123;</div><div class="line">    return_exam(0);</div><div class="line">&#125;</div><div class="line">int main ()</div><div class="line">&#123;</div><div class="line">    print();</div><div class="line">    printf(&quot;hello world!!! %s(),%s,%dn&quot;,__FILE__,__func__,__LINE__);</div><div class="line">    return 0;</div><div class="line">&#125;</div><div class="line"></div><div class="line">james@jsh:~/C_stuty/study$ ./a.out </div><div class="line">error: 0 file_name:define.c	function_name:print	line:25 .</div><div class="line">hello world!!! define.c(),main,30</div></pre></td></tr></table></figure>
<p>四 、# p r a g m a 指令的使用<br> 预处理中的# p r a g m a   指令，其作用是设置编译器的状态或指示编译器完成一些特定的动作。使用# p r a g m a 指令的一般形式为：</p>
<p>  #pragma  para<br>其中，p a r a 为参数。下面对一些常见的参数进行讲解。</p>
<p>1） # p r a g m a     m e s s a g e ( “ 消息” )<br> 至于“# p r a g m a   m e s s a g e ( “ 消息” ) ”究竟有什么作用，可以通过下面的一段代码来了解其<br>具体的使用方式。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">#include&lt;stdio.h&gt;      </div><div class="line"></div><div class="line">#define STR   </div><div class="line"></div><div class="line">void main(int argc,char*argv)    </div><div class="line">&#123;    </div><div class="line">    printf(&quot; 学习#pragma命令中message参数的使用!n&quot;);</div><div class="line">#ifdef STR   </div><div class="line">#pragma message(&quot;STR 已经定义过了&quot;)   </div><div class="line">#endif </div><div class="line">&#125;</div><div class="line">james@jsh:~/C_stuty/study$ cc pragma.c </div><div class="line">pragma.c: In function ‘main’:</div><div class="line">pragma.c:9: note: #pragma message: STR 已经定义过了</div><div class="line">james@jsh:~/C_stuty/study$ ./a.out</div></pre></td></tr></table></figure>
<p> 学习#pragma命令中message参数的使用!</p>
<p> 我们发现，在编译的时候会打印出m e s s a g e 参数中的信息。通过这种方式，可以在代码<br>中输出想要的信息，也可以看某个宏是否已经被定义过。与之前使用p r i n t f ( ) 函数实现打印<br>的不同之处在于：m e s s a g e 打印消息出现在编译的时候，不会出现在程序最终的运行结果中；<br>而p r i n t f ( ) 函数的打印消息却会出现在最终的运行结果中。有时候，我们并不希望运行结果<br>中出现与结果无关的信息，这时可以使用# p r a g m a 命令，选择m e s s a g e 参数来实现信息的打<br>印输出。</p>
<p>2 ）# p r a g m a   o n c e<br>    如果在头文件的开头部分加入这条指令，那么就能保证头文件只被编译一次。</p>
<p>3 ）# p r a g m a   h d r s t o p<br> 该指令表示编译头文件到此为止，后面的无需再编译了。</p>
<p>4 ）# p r a g m a     p a c k ( )</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">int main()</div><div class="line">&#123;</div><div class="line">#pragma pack(2)</div><div class="line"></div><div class="line">    struct stu1_&#123;</div><div class="line">        char name[20];</div><div class="line">        char num[20];</div><div class="line">        int score;</div><div class="line">        char sex;</div><div class="line">    &#125;stu1;</div><div class="line"></div><div class="line">    printf(&quot;stu1 占用的内存大小为：%dn&quot;,sizeof(stu1));</div><div class="line">#pragma pack()</div><div class="line"></div><div class="line">    struct stu2_&#123;</div><div class="line">        char name[20];</div><div class="line">        char num[20];</div><div class="line">        int score;</div><div class="line">        char sex;</div><div class="line">    &#125;stu2;</div><div class="line"></div><div class="line">    printf(&quot;stu2 占用的内存大小为：%dn&quot;,sizeof(stu2));</div><div class="line"></div><div class="line">    return 0;</div><div class="line">&#125;</div><div class="line">james@jsh:~/C_stuty/study$ ./a.out </div><div class="line">stu1 占用的内存大小为：46</div><div class="line">stu2 占用的内存大小为：48</div></pre></td></tr></table></figure>
<p>在上面的代码中，在结构体s t 1 的前面使用了# p r a g m a   p a c k ( 2 ) ，其作用是设置2 字节对齐，接下来使用了# p r a g m a   p a c k ( ) ，其作用是取消之前设置的字节对齐方式，采用默认的4字节对齐。在输出结果中，由于s t u 1 在内存中采用2 字节对齐，而s t u 2 在内存中采用4 字节对齐，所以它们输出的结果不一致。将上面的代码修改为以下的形式。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">int main()</div><div class="line">&#123;</div><div class="line">#pragma pack(push)</div><div class="line">#pragma pack(2)</div><div class="line"></div><div class="line">    struct stu1_&#123;</div><div class="line">        char name[20];</div><div class="line">        char num[20];</div><div class="line">        int score;</div><div class="line">        char sex;</div><div class="line">    &#125;stu1;</div><div class="line"></div><div class="line">    printf(&quot;stu1 占用的内存大小为：%dn&quot;,sizeof(stu1));</div><div class="line">#pragma pack(pop)</div><div class="line"></div><div class="line">    struct stu2_&#123;</div><div class="line">        char name[20];</div><div class="line">        char num[20];</div><div class="line">        int score;</div><div class="line">        char sex;</div><div class="line">    &#125;stu2;</div><div class="line"></div><div class="line">    printf(&quot;stu2 占用的内存大小为：%dn&quot;,sizeof(stu2));</div><div class="line"></div><div class="line">    return 0;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p> 运行结果与前面代码的运行结果完全一致。看看修改的地方，在设置2 字节对齐方式之前添加了一句代码“# p r a g m a   p a c k ( p u s h ) ”，其作用是保存当前默认的字节对齐方式，而把下面原本的“# p r a g m a   p a c k ( ) ”修改为“# p r a g m a   p a c k ( p o p ) ”，其作用是恢复默认的字节对齐方式，可以看出这里代码的功能与之前代码的功能完全一致。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://zqsds.github.io/2017/05/03/个人博客网站第一天/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhao Qiang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZQ'S blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/05/03/个人博客网站第一天/" itemprop="url">
                  个人博客网站第一天
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-03T09:32:21+08:00">
                2017-05-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>CSDN上的博客莫名其妙不能写了，让我很忧伤啊，第一天很开心！！</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="Zhao Qiang" />
          <p class="site-author-name" itemprop="name">Zhao Qiang</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">7</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              
                <span class="site-state-item-count">2</span>
                <span class="site-state-item-name">标签</span>
              
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Zhao Qiang</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  






  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  


  




	





  





  





  






  





  

  

  

  

</body>
</html>
